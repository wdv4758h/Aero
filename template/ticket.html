{% extends '_section.html' %}

{% block title %} Tickets {% endblock %}

{% block content %}
<div data-ng-controller="formPost">
    <div>
        <h1>Ticket Search</h1>
        <form ng-submit="processForm('/api/ticket/search')">
            <ul>
                <li>
                    <label for="departure_id">Departure</label>
                    {% include "include/airports.html" with {'id': 'departure_id', 'ng': 'formData.departure_id'} %}
                </li>
                <li>
                    <label for="arrival_id">Arrival</label>
                    {% include "include/airports.html" with {'id': 'arrival_id', 'ng': 'formData.arrival_id'} %}
                </li>
                <li>
                    <label for="trans_time">轉機次數</label>
                    <select id="trans_time" name="trans_time" data-ng-init="formData.trans_time=0" data-ng-model="formData.trans_time">
                        <option value="0" data-ng-selected="1">不設定</option>
                        <option value="1">不轉機</option>
                        <option value="2">至多一次</option>
                        <option value="3">至多兩次</option>
                    </select>
                </li>
                <li><input type="submit" value="Search"></li>
            </ul>
        </form>
    </div>

    <div>
        <h1>Search Result</h1>
        <table>
            <thead>
                <tr>
                    <td>Result</td>
                    <td>Flight Number</td>
                    <td>Departure IATA</td>
                    <td>Arrival IATA</td>
                    <td>Departure Time (local time)</td>
                    <td>Arrival Time (local time)</td>
                    <td>Flight Time</td>
                    <td>Transfer</td>
                    <td>Price</td>
                    <td>Options</td>
                </tr>
            </thead>
            <tbody>
                <tr data-ng-hide="!formReturn" data-ng-repeat="result in formReturn track by $index">
                    <td>[[ result.result_order ]]</td>
                    <td>[[ result.code ]]</td>
                    <td>[[ result.departure_iata ]]</td>
                    <td>[[ result.arrival_iata ]]</td>
                    <td>[[ result.departure_date ]]</td>
                    <td>[[ result.arrival_date ]]</td>
                    <td>[[ result.flight_time ]]</td>
                    <td>[[ result.transfer ]]</td>
                    <td>[[ result.fare ]]</td>
                    <td>
                        {% if _SESSION %}
                        <!--
                        add to compare list
                        <a data-ng-click="interest(result.id)">Compare</a>
                        -->
                        {% endif %}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
